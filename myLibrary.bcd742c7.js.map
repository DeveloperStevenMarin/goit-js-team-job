{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,uCAGMC,EAAaC,SAASC,eAAe,uBACrCC,EAAWF,SAASC,eAAe,qBACnCE,EAAmBH,SAASC,eAAe,oBAC3CG,EAAUJ,SAASK,cAAc,qBACnCC,EAAc,EACdC,EAAa,EAEjBR,EAAWS,iBAAiB,SAE5B,WAEET,EAAWU,UAAUC,IAAI,gBACzBR,EAASO,UAAUE,OAAO,gBAE1B,IAAMC,EAAoBC,KAAKC,MAAMC,aAAaC,QAAQ,gBAGpDC,EAAgBL,EAAkBM,KAAI,SAAAC,GAC1C,OAAOC,MACL,sCAAyDC,OAAnBF,EAAQ,aAAmBE,OAARC,EAAAC,QAAQ,iBACjEC,MAAK,SAAAC,G,OAAYA,EAASC,M,OAS9B,SAASC,EAAYC,GACnB,IAAIC,EAAa,GACjBC,QAAQC,IAAId,GACTO,MAAK,SAAAQ,GACJ,IAAMC,EAAsBrB,EAAkBsB,OAC9C3B,EAXc,SAAA0B,GAClB,OAAOA,GAAuB,GAAKE,KAAKC,KAAKH,EAAsB,IAAM,C,CAUxDI,CAAYJ,GACzB,IAAMK,GAAK,EAAAC,EAAAC,eAAcZ,EAAarB,GACtCH,EAAQqC,UAAYH,EAMpB,IAJA,IACMI,EAA6B,IAAhBd,EAAoB,EADtB,IAC2BA,EAAc,GACpDe,EAAWR,KAAKS,IAFL,GAEShB,EAAwBI,EAAWE,QAEpDW,EAAIH,EAAYG,EAAIF,EAAUE,IAAK,CAC1C,IAAMC,EAAOd,EAAWa,GACE,KAAtBC,EAAKC,eACPD,EAAKC,aAAe,sBAEtB,IACMC,EAAc,GAAsB3B,OADrB,8BACe,QAAuBA,OAAjByB,EAAKG,aACzCC,EAAaJ,EAAKK,OAAOjC,KAAI,SAAAkC,G,OAASA,EAAMC,I,IAAMC,KAAK,OACvDC,EAAY,qHAI4BlC,OADfyB,EAAKU,GAAG,sFAC4BnC,OAArB2B,EAAY,WAI1B3B,OAJmCyB,EAAKW,MACrE,qLAMOpC,OAHsByB,EAAKW,MAAM,iGAGjBpC,OAAhB6B,EAAW,OAA+C7B,OAA1C,IAAIqC,KAAKZ,EAAKC,cAAcY,cAAc,2HAMpE9B,GAAc0B,C,CAGhBpD,EAAiBsC,UAAYZ,C,IAE9B+B,OAAM,SAAAC,G,OAASC,QAAQD,MAAMA,E,IAsClC,SAASE,IACoB/D,SAASC,eAAe,gBAChC+D,UAAY1D,C,CArFjCqB,EAAY,GA6DZvB,EAAQI,iBAAiB,SAbzB,SAAyByD,GACvB,GAA6B,OAAzBA,EAAMC,OAAOC,QAAkB,CACjC,IAAMC,EAAeH,EAAMC,OAAOF,UAC5BK,EAAkBC,SAASF,GACZ,QAAjBA,IAEF9D,EAAc+D,EACdJ,EAAMM,kBACN5C,EAAYrB,G,KAOlBN,SACGC,eAAe,sBACfO,iBAAiB,QAASgE,EAAA3E,EAAA,CAAA2E,EAAAC,GAAAC,MAAA,SAAAC,I,uEACrBrE,EAAc,GAAC,C,sBACjBA,I,SACMqB,EAAY2C,SAAShE,I,OAC3ByD,I,4CAIN/D,SACGC,eAAe,sBACfO,iBAAiB,QAASgE,EAAA3E,EAAA,CAAA2E,EAAAC,GAAAC,MAAA,SAAAC,I,uEACrBrE,EAAcC,GAAU,C,sBAC1BD,I,SACMqB,EAAY2C,SAAShE,I,OAC3ByD,EAAsBO,SAAShE,I","sources":["src/watched.js"],"sourcesContent":["import { API_KEY } from './config';\r\nimport { generatePages } from './pagination';\r\n\r\nconst watchedBtn = document.getElementById('watched-movies--btn');\r\nconst queueBtn = document.getElementById('queue-movies--btn');\r\nconst watchedContainer = document.getElementById('movies-container');\r\nconst ulPages = document.querySelector('.pagination__page');\r\nlet currentPage = 1;\r\nlet totalPages = 1;\r\n\r\nwatchedBtn.addEventListener('click', renderwatchedMovies);\r\n\r\nfunction renderwatchedMovies() {\r\n  \r\n  watchedBtn.classList.add('current--btn');\r\n  queueBtn.classList.remove('current--btn')\r\n\r\n  const watchedMoviesList = JSON.parse(localStorage.getItem('watchedList'));\r\n  let moviesHTML = '';\r\n\r\n  const fetchPromises = watchedMoviesList.map(movieID => {\r\n    return fetch(\r\n      `https://api.themoviedb.org/3/movie/${movieID}?api_key=${API_KEY}&language=en`\r\n    ).then(response => response.json());\r\n  });\r\n\r\n  const total_pages = watchedMoviesLength => {\r\n    return watchedMoviesLength >= 20 ? Math.ceil(watchedMoviesLength / 20) : 1;\r\n  };\r\n\r\n  fetchMovies(1);\r\n\r\n  function fetchMovies(currentPage) {\r\n    let moviesHTML = '';\r\n    Promise.all(fetchPromises)\r\n      .then(moviesData => {\r\n        const watchedMoviesLength = watchedMoviesList.length;\r\n        totalPages = total_pages(watchedMoviesLength);\r\n        const li = generatePages(currentPage, totalPages);\r\n        ulPages.innerHTML = li;\r\n\r\n        const pageSize = 20;\r\n        const startIndex = currentPage === 1 ? 0 : (currentPage - 1) * pageSize;\r\n        const endIndex = Math.min(currentPage * pageSize, moviesData.length);\r\n\r\n        for (let i = startIndex; i < endIndex; i++) {\r\n          const data = moviesData[i];\r\n          if (data.release_date === '') {\r\n            data.release_date = 'Sin aÃ±o registrado';\r\n          }\r\n          const baseImageUrl = 'https://image.tmdb.org/t/p/';\r\n          const moviePoster = `${baseImageUrl}w500${data.poster_path}`;\r\n          const genreNames = data.genres.map(genre => genre.name).join(' | ');\r\n          const movieHTML = `\r\n            <div class=\"photo-card\">\r\n              <div class=\"info\">\r\n                <a onclick=\"openModal('${data.id}')\" class=\"info__poster\">\r\n                  <img class=\"info__poster--img\" src=\"${moviePoster}\" alt=\"${data.title\r\n            }\" loading=\"lazy\" width=\"100px\" height=\"100px\" id=\"info__poster--img\" />\r\n                </a>\r\n                <h3 class=\"info__title\">\r\n                  <strong class=\"title\">${data.title}</strong>\r\n                </h3>\r\n                <p class=\"info__genre\">\r\n                  ${genreNames} | ${new Date(data.release_date).getFullYear()}\r\n                </p>\r\n                <p class=\"info-item\"></p>\r\n              </div>\r\n            </div>\r\n          `;\r\n          moviesHTML += movieHTML;\r\n        }\r\n\r\n        watchedContainer.innerHTML = moviesHTML;\r\n      })\r\n      .catch(error => console.error(error));\r\n  }\r\n\r\n  function handlePageClick(event) {\r\n    if (event.target.tagName === 'LI') {\r\n      const clickedValue = event.target.innerText;\r\n      const clickedValueInt = parseInt(clickedValue);\r\n      if (clickedValue === '...') {\r\n      } else {\r\n        currentPage = clickedValueInt;\r\n        event.stopPropagation();\r\n        fetchMovies(currentPage);\r\n      }\r\n    }\r\n  }\r\n\r\n  ulPages.addEventListener('click', handlePageClick);\r\n\r\n  document\r\n    .getElementById('library__prev-page')\r\n    .addEventListener('click', async () => {\r\n      if (currentPage > 1) {\r\n        currentPage--;\r\n        await fetchMovies(parseInt(currentPage));\r\n        updateCurrentPageText(currentPage);\r\n      }\r\n    });\r\n\r\n  document\r\n    .getElementById('library__next-page')\r\n    .addEventListener('click', async () => {\r\n      if (currentPage < totalPages) {\r\n        currentPage++;\r\n        await fetchMovies(parseInt(currentPage));\r\n        updateCurrentPageText(parseInt(currentPage));\r\n      }\r\n    });\r\n\r\n  function updateCurrentPageText() {\r\n    const currentPageElement = document.getElementById('current-page');\r\n    currentPageElement.innerText = currentPage;\r\n  }\r\n}\r\n"],"names":["$bpxeT","parcelRequire","$6eff4d8afb430165$var$watchedBtn","document","getElementById","$6eff4d8afb430165$var$queueBtn","$6eff4d8afb430165$var$watchedContainer","$6eff4d8afb430165$var$ulPages","querySelector","$6eff4d8afb430165$var$currentPage","$6eff4d8afb430165$var$totalPages","addEventListener","classList","add","remove","watchedMoviesList","JSON","parse","localStorage","getItem","fetchPromises","map","movieID","fetch","concat","$8lXr3","API_KEY","then","response","json","fetchMovies","currentPage1","moviesHTML","Promise","all","moviesData","watchedMoviesLength","length","Math","ceil","total_pages","li","$dLAzy","generatePages","innerHTML","startIndex","endIndex","min","i","data","release_date","moviePoster","poster_path","genreNames","genres","genre","name","join","movieHTML","id","title","Date","getFullYear","catch","error","console","updateCurrentPageText","innerText","event","target","tagName","clickedValue","clickedValueInt","parseInt","stopPropagation","$parcel$interopDefault","$2TvXO","mark","_callee"],"version":3,"file":"myLibrary.bcd742c7.js.map"}